<!-- Copyright FUJITSU LIMITED 2016-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html" xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:adm="http://www.fujitsu.com/global/services/software/interstage"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:mp="http://www.fujitsu.com/global/services/software/interstage/marketplace"
                template="../templates/main.xhtml">
  
  <ui:define name="pageId">
    <c:set var="pageId" value="marketplace.account.attributes" />
    <c:set var="dirty" value="false" />
    <c:set var="imgUrl" value="#{facesContext.externalContext.requestContextPath}/marketplace/img" />
  </ui:define>

  <ui:define name="breadcrumbs">
    <mp:breadcrumbs>
      <mp:crumb labelPageId="marketplace.account" link="/marketplace/account/index.jsf" />
      <mp:crumb labelPageId="marketplace.account.attributes" />
    </mp:breadcrumbs>
  </ui:define>

  <ui:define name="aside">
    <mp:navigationMenu bean="#{accountNavigationBean}" selected="marketplace.account.attributes.title" />
  </ui:define>
  
 <ui:define name="contents">
    <a4j:outputPanel layout="block" styleClass="grid4span clearfix">
      <a4j:outputPanel layout="block" styleClass="box">
        <h:panelGroup id="operationsArea" rendered="true" layout="block">
          <mp:outputStep value="#{msg['marketplace.account.attributes.manageAttributes.title']}" />
          <c:set var="smallWidth" value="10%" />
          <c:set var="mediumWidth" value="25%" />
          <c:set var="restWidth" value="40%" />

          <h:form id="attributesListForm">
            <a4j:outputPanel id="attributesTablePanel" layout="block"
              styleClass="tablePanel table_padding minimumSizeTable">

              <c:set var="sortIcon" value="/marketplace/img/transparentPixel.png?id=sort" />
              <c:set var="sortIconAscending" value="/marketplace/img/transparentPixel.png?id=sortAscending" />
              <c:set var="sortIconDescending" value="/marketplace/img/transparentPixel.png?id=sortDescending" />

              <rich:dataTable headerClass="rowTitle" rowClasses="rowOdd,rowEven" id="attributesTable" width="100%"
                rows="10" value="#{manageAttributesCtrl.model.attributes}" var="item" selectionMode="single"
                enableContextMenu="false" noDataLabel=" " columnClasses="alignTop wrapColumns preWrapping"
                rendered="#{(not empty manageAttributesCtrl.model.attributes)}" sortMode="single"
                render="pagerPanel" style="width:100%">

                <f:facet name="header">
                  <a4j:outputPanel>
                    <adm:pager pagerId="attributePager" />
                  </a4j:outputPanel>
                </f:facet>
                <rich:column id="colUdaId" width="#{mediumWidth}" sortBy="#{item.udaId}" sortIcon="#{sortIcon}" 
                  sortIconAscending="#{sortIconAscending}" sortIconDescending="#{sortIconDescending}"
                  sortOrder="#{tableState.sortOrders['mpColUdaId']}"
                  filterType="custom" filterValue="#{tableState.filterValues['colUdaId']}"
                  filterExpression="#{adm:matchBegin(item.udaId, tableState.filterValues['colUdaId'], false)}" >
                  <f:facet name="header">
                    <h:outputText value="#{msg['marketplace.account.attributes.udaId']}" />
                    <adm:filterInput inputId="filterUdaId" inputValue="#{tableState.filterValues['colUdaId']}" 
                    render="attributesTable@body pagerPanel"
                    onkeyup="AdmUtils.setFirstPage(#{rich:element('attributePager')});" />
                  </f:facet>
                  <h:outputText value="#{item.udaId}" />
                </rich:column>
                
                <rich:column id="colVendor" width="#{mediumWidth}" sortBy="#{item.vendor.name}" sortIcon="#{sortIcon}" 
                  sortIconAscending="#{sortIconAscending}" sortIconDescending="#{sortIconDescending}"
                  sortOrder="#{tableState.sortOrders['mpColVendor']}"
                  filterType="custom" filterValue="#{tableState.filterValues['colVendor']}"
                  filterExpression="#{adm:matchBegin(item.vendor.name, tableState.filterValues['colVendor'], false)}" >
                  <f:facet name="header">
                    <h:outputText value="#{msg['marketplace.account.attributes.vendor']}" />
                    <adm:filterInput inputId="filterVendor" inputValue="#{tableState.filterValues['colVendor']}" 
                    render="attributesTable@body pagerPanel"
                    onkeyup="AdmUtils.setFirstPage(#{rich:element('attributePager')});" />
                  </f:facet>
                  <h:outputText value="#{item.vendor.name}" />
                </rich:column>

                <c:set var="scopeKey" value="UdaConfigurationType.#{item.udaDefinition.configurationType}" />
                <rich:column width="#{smallWidth}" sortBy="#{item.udaDefinition.configurationType}" sortIcon="#{sortIcon}" 
                  sortIconAscending="#{sortIconAscending}" sortIconDescending="#{sortIconDescending}" >
                  <f:facet name="header">
                    <h:outputText value="#{msg['marketplace.account.attributes.scope']}" />
                  </f:facet>
                  <h:outputText value="#{msg[scopeKey]}" />
                </rich:column>

                <rich:column id="colUdaValue" width="#{restWidth}" sortBy="#{item.udaValue}" sortIcon="#{sortIcon}" 
                  sortIconAscending="#{sortIconAscending}" sortIconDescending="#{sortIconDescending}"
                  sortOrder="#{tableState.sortOrders['mpColUdaValue']}"
                  filterType="custom" filterValue="#{tableState.filterValues['colUdaValue']}"
                  filterExpression="#{adm:matchBegin(item.udaValue, tableState.filterValues['colUdaValue'], false)}" >
                  <f:facet name="header">
                    <h:outputText value="#{msg['marketplace.account.attributes.value']}" />
                    <adm:filterInput inputId="filterUdaValue" inputValue="#{tableState.filterValues['colUdaValue']}" 
                    render="attributesTable@body pagerPanel"
                    onkeyup="AdmUtils.setFirstPage(#{rich:element('attributePager')});" />
                  </f:facet>
                  <h:inputText id="udaValue" onchange="setDirty(true)" value="#{item.udaValue}"
                    maxlength="#{appBean.descriptionLen}" required="#{item.inputMandatory}" 
                    label="#{item.udaId}" style="width:100%">
                  </h:inputText>
                </rich:column>
              </rich:dataTable>
            </a4j:outputPanel>

            <mp:pixelline />
            <adm:buttonPanel layout="block" styleClass="clearfix">
              <adm:button id="saveButton" value="#{msg['button.save']}" bean="#{manageAttributesCtrl}" action="saveAttributes" 
                rendered="#{(not empty manageAttributesCtrl.model.attributes)}"/>
            </adm:buttonPanel>
            
          </h:form>
        </h:panelGroup>
      </a4j:outputPanel>
    </a4j:outputPanel>
  </ui:define>
</ui:composition>